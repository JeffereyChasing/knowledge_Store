const CACHE_NAME="bagu-mock-cache-v2",OFFLINE_URL="/offline.html";self.addEventListener("install",n=>{console.log("ğŸ”„ Service Worker å®‰è£…ä¸­..."),n.waitUntil(caches.open(CACHE_NAME).then(n=>(console.log("ğŸ’¾ å¼€å§‹ç¼“å­˜ç¦»çº¿èµ„æº"),Promise.all([n.add(new Request(OFFLINE_URL,{cache:"reload"})),n.add("/manifest.json")]))).then(()=>(console.log("âœ… ç¦»çº¿èµ„æºç¼“å­˜å®Œæˆ"),self.skipWaiting())).catch(n=>{console.error("âŒ ç¼“å­˜å¤±è´¥:",n)}))}),self.addEventListener("activate",n=>{console.log("ğŸš€ Service Worker æ¿€æ´»ä¸­..."),n.waitUntil(Promise.all([self.clients.claim(),caches.keys().then(n=>Promise.all(n.map(n=>{if(n!==CACHE_NAME)return console.log("ğŸ—‘ï¸ åˆ é™¤æ—§ç¼“å­˜:",n),caches.delete(n)})))]))}),self.addEventListener("fetch",n=>{const{request:e}=n;if("navigate"===e.mode)return console.log("ğŸŒ å¤„ç†å¯¼èˆªè¯·æ±‚:",e.url),void n.respondWith((async()=>{try{const n=await fetch(e);return console.log("âœ… ç½‘ç»œè¯·æ±‚æˆåŠŸ"),n}catch(n){console.log("ğŸ“¶ ç½‘ç»œå¤±è´¥ï¼Œå‡†å¤‡è¿”å›ç¦»çº¿é¡µé¢");const e=await caches.open(CACHE_NAME);let t=await e.match(OFFLINE_URL);return t?(console.log("âœ… è¿”å›ç¼“å­˜çš„ç¦»çº¿é¡µé¢"),t):(console.log("âš ï¸ ç¼“å­˜ä¸­æœªæ‰¾åˆ°ç¦»çº¿é¡µé¢ï¼Œåˆ›å»ºæ–°çš„"),new Response('<!DOCTYPE html>\n            <html lang="zh-CN">\n            <head>\n                <meta charset="UTF-8">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>ç¦»çº¿æ¨¡å¼ - å…«è‚¡ç²¾Mock</title>\n                <style>\n                    body {\n                        font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', sans-serif;\n                        display: flex;\n                        justify-content: center;\n                        align-items: center;\n                        height: 100vh;\n                        margin: 0;\n                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n                        color: white;\n                    }\n                    .container {\n                        text-align: center;\n                        padding: 2rem;\n                        background: rgba(255, 255, 255, 0.1);\n                        border-radius: 16px;\n                        backdrop-filter: blur(10px);\n                        max-width: 400px;\n                    }\n                    h1 { margin-bottom: 1rem; }\n                    p { margin-bottom: 1.5rem; opacity: 0.9; }\n                    button {\n                        background: white;\n                        color: #667eea;\n                        border: none;\n                        padding: 12px 24px;\n                        border-radius: 25px;\n                        cursor: pointer;\n                        font-weight: 600;\n                    }\n                </style>\n            </head>\n            <body>\n                <div class="container">\n                    <h1>ğŸ“¶ ç¦»çº¿æ¨¡å¼</h1>\n                    <p>ç½‘ç»œè¿æ¥å·²æ–­å¼€ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</p>\n                    <button onclick="window.location.reload()">é‡æ–°åŠ è½½</button>\n                </div>\n                <script>\n                    window.addEventListener(\'online\', function() {\n                        window.location.reload();\n                    });\n                <\/script>\n            </body>\n            </html>',{headers:{"Content-Type":"text/html; charset=utf-8"}}))}})());e.url.endsWith("/offline.html")?n.respondWith(caches.match(OFFLINE_URL).then(n=>n||fetch(e))):e.url.startsWith(self.location.origin)&&n.respondWith(caches.match(e).then(n=>n||fetch(e)))});